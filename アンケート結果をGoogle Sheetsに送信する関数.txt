// アンケート結果をGoogle Sheetsに送信する関数
async function sendToGoogleSheets(data) {
    const sheetId = 'YOUR_SPREADSHEET_ID'; // スプレッドシートIDを指定
    const accessToken = 'YOUR_ACCESS_TOKEN'; // Google OAuth 2.0トークンを指定

    const response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/A1:append?valueInputOption=RAW`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${accessToken}`,
        },
        body: JSON.stringify({
            values: data,
        }),
    });

    if (response.ok) {
        console.log('データがスプレッドシートに送信されました');
    } else {
        console.error('スプレッドシートへの送信に失敗しました:', response.statusText);
    }
}

// アンケート結果の送信ボタンに連携
function submitSurvey() {
    const surveyResults = results.map(result => [result.x, result.y, result.answer]); // データを配列形式でまとめる
    sendToGoogleSheets(surveyResults);

    // ユーザーへの送信完了メッセージ
    document.getElementById('resultsContainer').innerHTML = '<h2>送信完了</h2><p>回答ありがとうございました。</p>';
}
